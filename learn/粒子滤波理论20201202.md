# 粒子滤波理论

粒子滤波通过**非参数化的蒙特卡洛模拟方法来实现递推贝叶斯滤波**，适用于任何能用状态空间模型描述的非线性系统，精度可以逼近最优估计。粒子滤波具有简单、易于实现等特点，它为分析非线性动态系统提供了一种有效的解决方法，从而引起**目标跟踪、信号处理以及自动控制领域**的广泛关注。本章首先概述用于求解目标状态后验概率的贝叶斯滤波理论，随后介绍具有普遍适应性的粒子滤波器，最后针对当前粒子滤波器存在的粒子多样性丧失问题，提出了一种量子进化粒子滤波算法。

## 贝叶斯滤波

动态系统的**目标跟踪**问题可以通过图2.1所示的**状态空间模型**来描述。本节在贝叶斯滤波框架下讨论目标跟踪问题。

![img](file:////tmp/wps-zk/ksohtml/wpsIk382L.jpg)

在目标跟踪问题中，动态系统的状态空间模型可描述为：

<img src="file:////tmp/wps-zk/ksohtml/wpsoXJ7yW.png" alt="img" style="zoom:150%;" />

其中f（）和h（）分别为状态转移方程与观测方程，

![img](file:////tmp/wps-zk/ksohtml/wpsclSnfJ.png)

## 贝叶斯重要性采样

蒙特卡洛模拟是一种利用随机数求解物理和数学问题的计算方法，又称为计算机随机模拟方法。该方法源于第一次世界大战期间美国研制原子弹的曼哈顿计划，著名数学家冯诺依曼作为该计划的主持人之一，用摩纳哥的蒙特卡洛来命名这种方法。蒙特卡洛模拟方法利用所求状态空间中大量的样本点来近似逼近待估计变量的后验概率分布，如图所示，从而将积分问题转换为有限样本点的求和问题。粒子滤波算法的核心思想便是利用一系列随机样本的加权和表示后验概率密度，通过求和来近似积分操作。假设可以从后验概率密度中/home/zk/zk/ROBOT/learn/photo/图片7.png中抽取N个独立同分布的随机样本

蒙特卡洛方法一般可以归纳为以下三个步骤：
1.构造概率模型。对于本身具有随机性质的问题，主要工作是正确的描述和模拟这个概率过程。对于确定性问题，比如计算定积分，求解线性方程组、偏微分方程等问题，采用蒙特卡洛方法求解需要实现构造一个人为的概率过程，将它的某些参量视为问题的解。

2.从指定的概率分布中采样。产生服从已知概率分布的随机变量是实现蒙特卡洛方法模拟实验的关键步骤。

3.建立各种估计量的估计。一般来说，构造出概率模型并能从中抽样后，便可进行模拟实验。随后，就要确定一个随机变量，将其作为待求解问题的解进行估计。

在实际计算中，通常无法直接从后验概率分布中采样，如何得到服从后验概率分布的随机样本是蒙特卡洛方法中基本的问题之一。重要性采样法引入一个已知的、容易采样的重要性概率密度函数XXX，从中生成采样粒子，利用这些随机样本的加权和来逼近后验滤波概率密度XXX，如图所示。

### 序贯重要性采样算法

在基于重要性采样的蒙特卡洛模拟方法中，估计后验滤波概率需要利用所有的观测数据，每次新的观测数据来到都需要重新计算整个状态序列的重要性权值。序贯重要性采样作为粒子滤波的基础，它将统计学中的序贯分析方法应用到蒙特卡洛方法中，从而实现后验滤波概率密度的递推估计。假设重要性概率密度函数

序贯重要性采样算法从重要性概率密度函数中生成采样粒子，并随着测量值的依次到来递推求得相应的权值，最终以粒子加权和的形式来描述后验滤波概率密度，进而得到状态估计。序贯重要性采样算法的流程可以用如下伪代码描述：

1.时间更新，根据重要性参考函数生成采样粒子

2.量测更新，根据最新观测值计算粒子权重

粒子权值归一化，并计算目标状态

为了得到正确的状态估计，通常希望粒子权值的方差尽可能趋近于零。然而，序贯蒙特卡洛方法一般都存在权值退化问题。在实际计算中，经过数次迭代，只有少数粒子的权值较大，其余粒子的权值可忽略不计。粒子权值的方差随着时间增大，状态空间中的有效粒子数较少。有效粒子数较少说明权值退化严重。因此一般采用以下两种途径：选择合适的重要性概率密度函数；在序贯重要性采样之后，采用重采样的方法。







